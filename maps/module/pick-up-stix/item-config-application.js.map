{"version":3,"sources":["module/pick-up-stix/item-config-application.ts"],"names":[],"mappings":"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","file":"../../../src/module/pick-up-stix/item-config-application.js","sourcesContent":["import { getCurrencies } from '../../utils';\r\nimport ContainerImageSelectionApplication from \"./container-image-selection-application.js\";\r\nimport { createOwnedEntity, currencyCollected, itemCollected, updateActor, updateToken } from './main';\r\nimport { ItemType } from \"./models\";\r\n\r\n/**\r\n * Application class to display to select an item that the token is\r\n * associated with\r\n */\r\nexport default class ItemConfigApplication extends FormApplication {\r\n\tprivate _tokenUpdateHandler;\r\n\tprivate _tokenDeletedHandler;\r\n\tprivate _html: any;\r\n\r\n\t/**\r\n\t * This is an object of the loot that this container holds. The keys are the loot type\r\n\t * `weapon`, `equipment`, `consumable`, `backpack`, `tool`, `loot`. The values will\r\n\t * be an array of Item instance data\r\n\t */\r\n\tprivate _loot: {\r\n\t\t[key: string]: any[];\r\n\t};\r\n\r\n\tstatic get defaultOptions(): ApplicationOptions {\r\n\t\treturn mergeObject(super.defaultOptions, {\r\n\t\t\tcloseOnSubmit: false,\r\n\t\t\tsubmitOnClose: false,\r\n\t\t\tsubmitOnChange: true,\r\n\t\t\tid: \"pick-up-stix-item-config\",\r\n\t\t\ttemplate: \"modules/pick-up-stix/module/pick-up-stix/templates/item-config.html\",\r\n\t\t\twidth: 720,\r\n\t\t\tminimizable: false,\r\n\t\t\ttitle: `${game.user.isGM ? 'Configure Loot Container' : 'Loot Container'}`,\r\n\t\t\tresizable: true,\r\n\t\t\tclasses: ['pick-up-stix', 'item-config-sheet'],\r\n\t\t\tdragDrop: [{ dropSelector: null }]\r\n\t\t});\r\n\t}\r\n\r\n\tconstructor(private _token: Token, private _controlledToken: Token) {\r\n\t\tsuper({});\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | constructor called with:`)\r\n\t\tconsole.log([this._token, this._controlledToken]);\r\n\t\tthis._loot = {\r\n\t\t\tcurrency: Object.keys(getCurrencies()).reduce((prev, k) => {\r\n\t\t\t\tprev[k] = 0;\r\n\t\t\t\treturn prev;\r\n\t\t\t}, {}),\r\n\t\t\t...duplicate(this._token.getFlag('pick-up-stix', 'pick-up-stix.containerLoot') ?? {})\r\n\t\t}\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | constructor | initial loot:`);\r\n\t\tconsole.log(this._loot);\r\n\t\tthis._tokenUpdateHandler = this._tokenUpdated.bind(this);\r\n\t\tthis._tokenDeletedHandler = this._tokenDeleted.bind(this);\r\n\t\tHooks.on('updateToken', this._tokenUpdateHandler);\r\n\t\tHooks.on('deleteToken', this._tokenDeletedHandler);\r\n\t}\r\n\r\n\tprotected _tokenDeleted(scene: Scene, tokenData: any, data: any, userId: string) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | _tokenDeleted called with args:`);\r\n\t\tconsole.log([scene, tokenData, data, userId]);\r\n\r\n\t\tif (tokenData._id === this._token.id) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | _tokenDeleted | token ID matches this app's token`)\r\n\t\t\tthis.close();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _tokenUpdated(scene, data, flags, options, userId) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _tokenUpdated called with args:`);\r\n\t\tconsole.log([scene, data, flags, options, userId]);\r\n\r\n\t\tif (data._id === this._token.id) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _tokenUpdated | token has been updated, re-render`);\r\n\t\t\tthis._loot = duplicate(this._token.getFlag('pick-up-stix', 'pick-up-stix.containerLoot') ?? {});\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t}\r\n\r\n\tactivateListeners(html) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | activateListeners`);\r\n\t\tthis._html = html;\r\n\t\tsuper.activateListeners(this._html);\r\n\r\n\t\t// set the click listener on the image\r\n\t\t$(html).find(`[data-edit=\"img\"]`).click(e => this._onEditImage(e));\r\n\r\n\t\t// set click listeners on the buttons to pick up individual items\r\n\t\t$(html).find(`a.item-take`).click(e => this._onTakeItem(e));\r\n\r\n\t\t// set click listener for taking currency\r\n\t\t$(html).find(`a.currency-take`).click(e => this._onTakeCurrency(e));\r\n\r\n\t\t$(html).find(`input[type=\"text\"]`).prop('readonly', !game.user.isGM);\r\n\t\t$(html).find(`input[type=\"text\"]`).prop('disabled', \t!game.user.isGM);\r\n\r\n\t\t$(html).find('input#canCloseCheckbox').prop('checked', this._token.getFlag('pick-up-stix', 'pick-up-stix.canClose') ?? true);\r\n\r\n\t\t$(html).find('input#scale').val(this._token.data.scale);\r\n\r\n\t\tif (!game.user.isGM) {\r\n\t\t\t$(html).find(`input[type=\"text\"]`).addClass('isNotGM');\r\n\t\t}\r\n\t}\r\n\r\n\tgetData() {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | getData:`);\r\n\t\tconst data = {\r\n\t\t\tobject: this._token.data,\r\n\t\t\tcontainerDescription: getProperty(this._token.data, 'flags.pick-up-stix.pick-up-stix.initialState.itemData.data.description.value')?.replace(/font-size:\\s*\\d*.*;/, 'font-size: 16px;') ?? '',\r\n\t\t\tlootTypes: Object.keys(this._loot).filter(lootKey => lootKey !== 'currency'),\r\n\t\t\tloot: Object.entries(this._loot).reduce((prev, [lootKey, lootItems]) => {\r\n\t\t\t\tif (lootKey === 'currency') {\r\n\t\t\t\t\tprev[lootKey] = lootItems;\r\n\t\t\t\t\treturn prev;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprev[lootKey] = lootItems.map(i => ({ ...i, price: i.qty * i.data.price }));\r\n\t\t\t\treturn prev;\r\n\t\t\t}, {}),\r\n\t\t\tcurrencyTypes: Object.entries(getCurrencies()).map(([k, v]) => ({ short: k, long: v })),\r\n\t\t\tuser: game.user\r\n\t\t};\r\n\t\tconsole.log(data);\r\n\t\treturn data;\r\n\t}\r\n\r\n\tprotected async _onTakeCurrency(e) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | _onTakeCurrency`);\r\n\t\tconst actor: Actor = this._controlledToken?.actor;\r\n\t\tif (!actor) {\r\n\t\t\tui.notifications.error('You must be controlling only one token to pick up an item');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst currentCurrency = { ...getProperty(actor, 'data.data.currency') };\r\n\t\tconst lootCurrencies = this._loot['currency'];\r\n\t\tif (!Object.values(lootCurrencies).some(c => c > 0)) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemCOnfigApplication ${this.appId} | _onTakeCurrency | No currency to loot`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tObject.keys(currentCurrency).forEach(k => currentCurrency[k] = +currentCurrency[k] + +lootCurrencies[k]);\r\n\t\tawait updateActor(actor, {'data.currency': currentCurrency});\r\n\r\n\t\tcurrencyCollected(this._controlledToken, Object.entries(lootCurrencies).filter(([, v]) => v > 0).reduce((prev, [k, v]) => { prev[k] = v; return prev; }, {}));\r\n\r\n\t\tObject.values(this._loot['currency'])?.forEach(k => this._loot['currency'][k] = 0);\r\n\t\t$(this._html).find('[data-currency-input').val(0);\r\n\t\tawait this.submit({});\r\n\t}\r\n\r\n\tprotected async _onTakeItem(e) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | _onTakeItem`);\r\n\t\tconst actor = this._controlledToken?.actor;\r\n\t\tif (!actor) {\r\n\t\t\tui.notifications.error('You must be controlling only one token to pick up an item');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst itemType = $(e.currentTarget).parents(`ol[data-itemType]`).attr('data-itemType');\r\n\t\tconst itemId = e.currentTarget.dataset.id;\r\n\t\tconst itemData = this._loot?.[itemType]?.find(i => i._id === itemId);\r\n\t\tif (--itemData.qty <= 0) {\r\n\t\t\tthis._loot?.[itemType]?.findSplice(v => v._id === itemId);\r\n\t\t}\r\n\t\tsetProperty(itemData, 'flags.pick-up-stix.pick-up-stix', {\r\n\t\t\tinitialState: { id: itemData._id, count: 1, itemData: { ...itemData, flags: {} } },\r\n\t\t\titemType: ItemType.ITEM,\r\n\t\t\tisLocked: false\r\n\t\t});\r\n\t\tconsole.log(itemData)\r\n\t\tconsole.log(this._loot);\r\n\t\tawait createOwnedEntity(actor, [itemData]);\r\n\t\titemCollected(this._controlledToken, itemData);\r\n\r\n\t\tawait this.submit({});\r\n\t}\r\n\r\n\tprotected _onEditImage(e) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onEditImage`);\r\n\t\tconst f = new ContainerImageSelectionApplication(this._token).render(true);\r\n\r\n\t\tHooks.once('closeContainerImageSelectionApplication', () => {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | closeContainerImageSelectionApplication hook`);\r\n\t\t\tthis.submit({});\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async _onDrop(e) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop with data:`);\r\n\t\tconst droppedData = JSON.parse(e.dataTransfer.getData('text/plain'));\r\n\t\tconsole.log(droppedData);\r\n\r\n\t\tif (droppedData.type !== \"Item\") {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop | item is not 'Item' type`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet itemData = droppedData.data ?? await game.items.get(droppedData.id)?.data ?? await game.packs.get(droppedData.pack).getEntry(droppedData.id);\r\n\r\n\t\tif (droppedData.actorId) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop | drop data contains actor ID '${droppedData.actorId}', delete item from actor`);\r\n\t\t\tawait game.actors.get(droppedData.actorId).deleteOwnedItem(droppedData.data._id);\r\n\t\t\titemData = { ...getProperty(itemData, 'flags.pick-up-stix.pick-up-stix.initialState.itemData') };\r\n\t\t}\r\n\r\n\t\tconst itemType = itemData.type;\r\n\r\n\t\tif (!this._loot[itemType]) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop | no items of type '${itemType}', creating new slot`);\r\n\t\t\tthis._loot[itemType] = [];\r\n\t\t}\r\n\t\tconst existingItem = this._loot?.[itemType]?.find(i => i._id === itemData._id);\r\n\t\tif (existingItem) {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop | existing data for type '${itemType}', increase quantity by 1`);\r\n\t\t\texistingItem.qty++;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId}  | _onDrop | existing data for item '${itemData._id}' does not exist, set quantity to 1 and add to slot`);\r\n\t\t\titemData.qty = 1;\r\n\t\t\tthis._loot[itemType].push(itemData);\r\n\t\t}\r\n\r\n\t\tawait this.submit({});\r\n\t}\r\n\r\n\tprotected async _updateObject(e, formData) {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | _onUpdateObject`);\r\n\t\tformData.img = this._token.getFlag('pick-up-stix', 'pick-up-stix.isOpen') ? this._token.getFlag('pick-up-stix', 'pick-up-stix.imageContainerOpenPath') : this._token.getFlag('pick-up-stix', 'pick-up-stix.imageContainerClosedPath');\r\n\t\tconst formDuplicate = duplicate(formData);\r\n\t\tconsole.log(`pick-up-stix | ItemConfigAPplication | original 'formData' object:`);\r\n\t\tconsole.log(formDuplicate);\r\n\r\n\t\tObject.entries(this._loot).filter(([k,]) => k !== 'currency').forEach(([k, v]) => {\r\n\t\t\tif (v.length === 0) {\r\n\t\t\t\tsetProperty(formData, `flags.pick-up-stix.pick-up-stix.containerLoot.-=${k}`, null);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsetProperty(formData, `flags.pick-up-stix.pick-up-stix.containerLoot.${k}`, Object.entries(v).reduce((prev, [index, v]) => {\r\n\t\t\t\t\tprev.push({\r\n\t\t\t\t\t\t...v,\r\n\t\t\t\t\t\tqty: e.type === 'change' && e.currentTarget.dataset.hasOwnProperty('quantityInput') && e.currentTarget.dataset.lootType === v.type && e.currentTarget.dataset.lootId === v._id ? $(e.currentTarget).val() : v.qty,\r\n\t\t\t\t\t\tflags: {}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn prev;\r\n\t\t\t\t}, []));\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconsole.log(`pick-up-stix | ItemConfigAPplication | new 'formData' object:`);\r\n\t\tconsole.log(formData);\r\n\t\tconst flattendOb = flattenObject(formData);\r\n\t\tconsole.log(`pick-up-stix | ItemConfigAPplication | flattend 'formData' object:`);\r\n\t\tconsole.log(flattendOb);\r\n\t\tawait updateToken(this._token, flattendOb);\r\n\t\tthis.render();\r\n\t}\r\n\r\n\tasync close() {\r\n\t\tconsole.log(`pick-up-stix | ItemConfigApplication ${this.appId} | close`);\r\n\t\tHooks.off('updateToken', this._tokenUpdateHandler);\r\n\t\tHooks.off('deleteToken', this._tokenDeletedHandler);\r\n\t\treturn super.close();\r\n\t}\r\n}\r\n"]}